{%- extends config.RECORDS_UI_BASE_TEMPLATE %}

{%- block page_body %}
{% include('reroils_data/_patron_profile_head.html') %}

<div id="patron_profile_tabs" class="container">
    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active">
            <a href="#loan" data-toggle="tab">{{ _('Loan') }} ({{ loans|length}})</a>
        </li>
        <li role="presentation">
            <a href="#pending" data-toggle="tab">{{ _('Pending') }} ({{ pendings|length}})</a>
        </li>
        <li role="presentation">
            <a href="#user" data-toggle="tab">{{ _('Personal data')}}</a>
        </li>
    </ul>
    <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="loan">
            {% if loans|length > 0 %}
                {{ build_table(loans) }}
            {% else %}
                <p style="margin-top: 10px; font-weight: bold">{{ _('No loan') }}</p>
            {% endif %}
        </div>
        <div role="tabpanel" class="tab-pane" id="pending">
            {% if pendings|length > 0 %}
                {{ build_table(pendings) }}
            {% else %}
                <p style="margin-top: 10px; font-weight: bold">{{ _('No pending') }}</p>
            {% endif %}
        </div>
        <div role="tabpanel" class="tab-pane" id="user">
            {% include('reroils_data/_patron_profile_personal.html') %}
        </div>
    </div>
</div>
{%- endblock %}

{% macro build_table(documents) %}
<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th class="col-md-6" scope="col">Title</th>
                <th class="col-md-2" scope="col">Call Number</th>
                <th class="col-md-2" scope="col">Library</th>
                <th class="col-md-2" scope="col">Return due</th>
                <th class="col-md-1" scope="col">Renewals</th>
            </tr>
        </thead>
        <tbody>
            {% for document in documents %}
            <tr>
                <td>{{ document.title }}</td>
                <td>{{ document.item.callNumber }}</td>
                <td>-</td>
                <td>
                    {{ document.item.holding.end_date|format_date(
                        format='short_date',
                        locale=current_i18n.locale.language
                    )}}</td>
                <td>-</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endmacro %}
